# Release v1.8.3 - CSV Multi-Value Separator Standardization & Enhanced Dry-Run

**Release Date:** February 6, 2026  
**Status:** ‚úÖ Production Ready  
**Previous Release:** [v1.8.0](v1.8.0.md) (February 6, 2026)

---

## üéØ Overview

v1.8.3 refines the **Unified Catalog Term Import system** by standardizing multi-value field separators and providing enhanced visibility into the import process. This release ensures cleaner CSV handling and better transparency during dry-run previews.

### Key Statistics

- **Unified Multi-Value Separator** - All multi-value fields now use semicolon (`;`) exclusively
- **Enhanced Dry-Run Output** - Visual indicators showing post-processing operations
- **CSV Format Clarity** - Definitive column reference documentation
- **Bug Fixes** - Improved separator parsing logic

---

## ‚ú® What's New

### üîß CSV Multi-Value Separator Standardization

**Problem Solved:**
Previous versions supported both comma (`,`) and semicolon (`;`) separators for multi-value fields, causing ambiguity and potential parsing conflicts since CSV format uses comma as the column delimiter.

**Solution:**
v1.8.3 standardizes all multi-value field separators to **semicolon (`;`) only**.

**Affected Fields:**
- `acronyms` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `owner_ids` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `experts` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `synonyms` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `related_terms` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `related_term_ids` - Changed from mixed `[",";",";","]` to `[";";";";","]`
- `resource_name` - Changed from mixed to **`;` only**
- `resource_url` - Changed from mixed to **`;` only**

**CSV Format Changes:**

‚ùå **OLD (v1.8.0):**
```csv
term_id,name,acronyms,owner_ids,experts,synonyms,related_terms
T001,Client,CLT,CUST,CLI,owner1,owner2,expert1,expert2,Customer,Consumer,Related1,Related2
```

‚úÖ **NEW (v1.8.3):**
```csv
term_id,name,acronyms,owner_ids,experts,synonyms,related_terms
T001,Client,CLT;CUST;CLI,owner1;owner2,expert1;expert2,Customer;Consumer,Related1;Related2
```

**Rationale:**
Since CSV format uses comma (`,`) as the column delimiter, using comma for multi-value separation creates ambiguity:
- Value string `"a, b, c"` could be misinterpreted as 3 columns
- **Semicolon (`;`)** is unambiguous and universally supported
- No conflicts with CSV column parsing

**Backward Compatibility:**
‚ö†Ô∏è **BREAKING CHANGE:** CSV files using comma-separated multi-values will require updating. Use semicolons for all multi-value fields.

**Migration Path:**
Find and replace in your CSV:
```powershell
# PowerShell: Replace commas with semicolons for specific columns
# For acronyms column: Find "CLT,CUST,CLI" ‚Üí Replace with "CLT;CUST;CLI"
```

---

### üëÅÔ∏è Enhanced Dry-Run Output with Post-Processing Indicators

**Problem Solved:**
Dry-run output wasn't showing post-processing operations (parent linking, expert addition, synonym creation), making it unclear what would actually happen during import.

**Solution:**
v1.8.3 adds visual indicators using yellow arrows (`‚Üí Will...`) to show all planned operations.

**Example Dry-Run Output:**

```
Term 1 - Business Glossary:
  Acronyms: BIZTERM

Term 2 - Paiement:
  Acronyms: PAY
  ‚Üí Will search for parent 'Business Glossary' and link after creation
  Experts: 1 expert(s)
  ‚Üí Will add 1 expert(s) after creation
  ‚Üí Will create/link 2 synonym(s) after creation

Term 3 - Client:
  Acronyms: CLT;CUST
  Owners: 1 owner(s)
  ‚Üí Will search for parent 'Paiement' and link after creation
  ‚Üí Will link 2 related term(s)
  Resources: 2 resource(s)
```

**Post-Processing Operations Shown:**
- ‚úÖ `‚Üí Will search for parent 'X' and link after creation` - Parent term lookup and linking
- ‚úÖ `‚Üí Will add N expert(s) after creation` - Expert contact assignment
- ‚úÖ `‚Üí Will create/link N synonym(s) after creation` - Synonym relationships
- ‚úÖ `‚Üí Will link N related term(s)` - Related term relationships

**Benefit:**
Users can now see the complete import flow before execution, including all relationship operations that occur during post-processing.

---

### üìö Comprehensive Column Reference Documentation

**New Documentation Files:**

1. **[UC_TERMS_CSV_COLUMNS_REFERENCE.md](../samples/csv/UC_TERMS_CSV_COLUMNS_REFERENCE.md)**
   - Complete list of all supported columns with variantes
   - Separator rules for each field
   - Examples for each column type
   - Migration guide from older formats

2. **[UC_TERMS_ALL_FIELDS_EXAMPLE.csv](../samples/csv/uc_terms_all_fields_example.csv)**
   - Template with all 18+ supported fields
   - 15 comprehensive examples
   - Shows proper semicolon separators

3. **[UC_TERMS_MULTIVALUE_EXAMPLE.csv](../samples/csv/uc_terms_multivalue_example.csv)**
   - 10 terms demonstrating multi-value JSON arrays in custom attributes
   - Hierarchical structure examples
   - Proper escaping for JSON values

**Quick Reference Table:**

| Column Type | Separator | Example |
|-------------|-----------|---------|
| `acronyms` | `;` | `CLT;CUST;CLI` |
| `owner_ids` | `;` | `guid1;guid2;guid3` |
| `experts` | `;` | `expert-guid1;expert-guid2` |
| `synonyms` | `;` | `Customer;Consumer;Client` |
| `parent_term_name` | None | `Business Terms` |
| `related_terms` | `;` | `Term1;Term2;Term3` |
| `resource_name` | `;` | `Guide;API;Tutorial` |
| `resource_url` | `;` | `https://a.com;https://b.com` |
| `customAttributes.*` | JSON | `"[""val1"",""val2""]"` |

---

## üêõ Bug Fixes

### Fixed Separator Parsing Logic
- ‚úÖ Removed fallback comma parsing from all multi-value fields
- ‚úÖ Implemented exclusive semicolon separator handling
- ‚úÖ Improved validation warnings for incompatible formats
- ‚úÖ Consistent parsing behavior across all field types

### Improved Error Messages
- ‚úÖ Clearer warnings when emails used instead of GUIDs
- ‚úÖ Better feedback for malformed custom attribute JSON
- ‚úÖ More detailed debug output for separator parsing

---

## üìã Migration Guide (v1.8.0 ‚Üí v1.8.3)

### Step 1: Update CSV Files
Replace comma separators with semicolons in multi-value fields:

| Field | Old Format | New Format |
|-------|-----------|-----------|
| acronyms | `CLT,CUST,CLI` | `CLT;CUST;CLI` |
| owner_ids | `id1,id2,id3` | `id1;id2;id3` |
| experts | `e1,e2,e3` | `e1;e2;e3` |
| synonyms | `Syn1,Syn2,Syn3` | `Syn1;Syn2;Syn3` |

### Step 2: Validate with Dry-Run
```powershell
pvw uc term import-csv --csv-file yourfile.csv --domain-id <DOMAIN_ID> --dry-run
```

### Step 3: Review Post-Processing Operations
Look for `‚Üí Will...` indicators showing planned operations.

### Step 4: Execute Import
```powershell
pvw uc term import-csv --csv-file yourfile.csv --domain-id <DOMAIN_ID>
```

---

## ‚úÖ Validation Checklist

- [x] All multi-value fields use semicolon separator
- [x] Custom attributes use proper JSON escaping: `"[""val1"",""val2""]"`
- [x] Owner/Expert IDs are GUIDs (not emails)
- [x] Parent term names exist in vocabulary
- [x] CSV uses UTF-8 encoding

---

## üìä Code Changes Summary

### Modified Files
- **purviewcli/cli/unified_catalog.py** (5 separator parsing sections updated)
  - Lines ~1713: Acronym parsing
  - Lines ~1783: Owner_ids parsing  
  - Lines ~1789-1801: Experts parsing
  - Lines ~1821-1826: Synonyms parsing
  - Lines ~1837-1845: Related_terms/related_term_ids parsing
  - Lines ~1870-1920: Enhanced dry-run output with post-processing indicators

### Created Files
- `samples/csv/UC_TERMS_CSV_COLUMNS_REFERENCE.md` - Complete column reference
- `samples/csv/uc_terms_all_fields_example.csv` - All-field template
- `samples/csv/uc_terms_multivalue_example.csv` - Multi-value examples

---

## üìù Examples

### Example 1: Basic Terms with Parent
```csv
term_id,name,description,status,parent_term_name
T001,Business Glossary,Root terms,Published,
T002,Paiement,Payment processing,Draft,Business Glossary
T003,Remboursement,Refund process,Draft,Paiement
```

### Example 2: With Multi-Value Fields
```csv
term_id,name,acronyms,synonyms,related_terms
T001,Client,CLT;CUST;CLI,Customer;Consumer,Produit;Commande
T002,Produit,PRD;PROD,Item;SKU,Client;Commande
```

### Example 3: With Contacts
```csv
term_id,name,owner_ids,experts,synonyms
T001,Client Premium,owner-guid-1;owner-guid-2,expert1;expert2,VIP Client;Elite Customer
```

### Example 4: With Resources
```csv
term_id,name,resource_name,resource_url
T001,Client,CRM Guide;API Documentation,https://crm.com/guide;https://api.com/docs
```

---

## üöÄ Usage Examples

### Import with Dry-Run Preview
```powershell
pvw uc term import-csv --csv-file "terms.csv" --domain-id "bc785cdb-..." --dry-run
```

### Import with Update Flag
```powershell
pvw uc term import-csv --csv-file "terms.csv" --domain-id "bc785cdb-..." --update-existing
```

### Import with Debug Output
```powershell
pvw uc term import-csv --csv-file "terms.csv" --domain-id "bc785cdb-..." --debug
```

---

## ‚ö†Ô∏è Breaking Changes

- **CSV Format:** All multi-value fields now require semicolon (`;`) separator, not comma (`,`)
- **Validation:** Stricter parsing - comma-separated values will not be split automatically

## üîÑ Backward Compatibility

- ‚úÖ All existing single-value fields unchanged
- ‚úÖ Parent term lookup by name still supported
- ‚úÖ Custom attributes still support nested structures
- ‚úÖ Resource linking unchanged
- ‚ùå Multi-value fields with commas require update

---

## üéØ Known Limitations

1. **Email-based Owner/Expert Assignment:** Must use Entra Object IDs (GUIDs), not email addresses
2. **Parent Term by Name:** Requires exact term name match
3. **2-Step Custom Attributes:** CREATE happens before custom attributes applied
4. **Semicolon in Values:** Values containing semicolons cannot be in multi-value fields

---

## üìû Support & Feedback

For issues or feature requests related to CSV import:

```powershell
# Enable debug output for troubleshooting
pvw uc term import-csv --csv-file "terms.csv" --domain-id "<DOMAIN_ID>" --debug

# Check for validation warnings
pvw uc term import-csv --csv-file "terms.csv" --domain-id "<DOMAIN_ID>" --dry-run
```

---

## üìö Related Documentation

- [UC_TERMS_CSV_COLUMNS_REFERENCE.md](../samples/csv/UC_TERMS_CSV_COLUMNS_REFERENCE.md) - All column types
- [UC_TERMS_ALL_FIELDS_EXAMPLE.csv](../samples/csv/uc_terms_all_fields_example.csv) - Complete template
- [UC_TERMS_MULTIVALUE_EXAMPLE.csv](../samples/csv/uc_terms_multivalue_example.csv) - Multi-value examples
- [UC_TERMS_MULTIVALUE_README.md](../samples/csv/UC_TERMS_MULTIVALUE_README.md) - JSON array guide

---

**Release Notes Compiled:** February 6, 2026  
**Status:** ‚úÖ Ready for Production  
**Next Release:** v1.8.4 (TBD)
