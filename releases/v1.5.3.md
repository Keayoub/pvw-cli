# v1.5.3 Release Notes

## New Features

### Custom Attributes Support for Unified Catalog Terms

#### Import Custom Attributes via CSV
- **Feature**: `pvw uc term import-csv` now supports custom attributes
- **Syntax**: Use dot notation in CSV column headers
  - Flat: `customAttributes.fieldName`
  - Nested: `customAttributes.Group.Field`
  - Multi-level: `customAttributes.Group.SubGroup.Field`

**Example CSV:**
```csv
name,description,customAttributes.DataProductGovernance.BusinessDomain,customAttributes.DataProductGovernance.ComplianceStatus
Customer Data,Customer information,Finance,Compliant
Product Catalog,Product catalog,Sales,Under Review
```

#### Update Custom Attributes via CLI
- **Feature**: `pvw uc term update` now accepts `--custom-attributes` parameter
- **Usage**: `pvw uc term update --term-id <id> --custom-attributes '<json>'`

**Example:**
```bash
pvw uc term update --term-id abc123 --custom-attributes '{"DataProductGovernance": {"BusinessDomain": "Finance"}}'
```

#### Update Custom Attributes via CSV
- **Feature**: `pvw uc term update-csv` now supports nested custom attributes
- **Syntax**: Same dot notation as import-csv

**Example CSV:**
```csv
term_id,customAttributes.DataProductGovernance.BusinessDomain
abc123,Finance
def456,Sales
```

### Implementation Details

**Import Process:**
1. CREATE term without custom attributes (API limitation)
2. UPDATE term to add custom attributes
3. Automatic 2-step process handled transparently

**Custom Attribute Structure:**
- Dot notation in CSV automatically converts to nested JSON
- Example: `customAttributes.Group.Field.SubField` â†’ `{"Group": {"Field": {"SubField": value}}}`
- Supports unlimited nesting levels

**Debug Mode:**
- Use `--debug` flag to see payload structures
- Shows parsed custom attributes at each step
- Displays full JSON sent to API for troubleshooting

## Bug Fixes

### Fixed Entity Bulk Update
- Fixed name collision where Python `list()` builtin was shadowed by Click command
- Entity `bulk-update-csv` now works correctly

### Improvements

- Enhanced error handling for custom attributes parsing
- Better logging and debugging information
- More robust nested attribute structure creation

## Technical Notes

### API Behavior
- Purview API doesn't support custom attributes during term creation
- Custom attributes can only be set via UPDATE operation
- API GET responses don't include custom attribute values (UI-only display)
- **Verification**: Check Purview UI to confirm custom attributes are saved

### Supported Formats

**Custom Attribute Groups Tested:**
- `DataProductGovernance` (BusinessDomain, ComplianceStatus, DataClassification, ProductOwner)
- `Glossaire` (Reference)
- Any custom group defined in governance domain

## Testing

All features tested with:
- Single term import/update
- Bulk import (2-3 terms) with custom attributes
- Multiple custom attribute groups simultaneously
- Nested attributes with 2-3 levels
- Domain: `bc785cdb-11c3-4227-ab44-f6ad44048623`

## Version Info
- **Version**: 1.5.3
- **Release Date**: 2026-01-19
- **Python**: 3.8+
- **Dependencies**: No new dependencies

## Migration Guide

### From v1.5.2
No breaking changes. All existing commands continue to work.

New optional parameters:
- `pvw uc term update --custom-attributes <json>` (new)
- `--debug` flag for troubleshooting

## Known Limitations

1. **API Limitation**: Custom attributes cannot be set during term creation, only via update
2. **Value Verification**: API GET doesn't return custom attribute values; must verify in Purview UI
3. **Performance**: Import with custom attributes is slower (requires CREATE + UPDATE per term)

## Examples

### Example 1: Import Terms with Multiple Custom Attribute Groups

```bash
# Create CSV file: glossaire_terms.csv
# Headers: name,description,customAttributes.Glossaire.Reference,customAttributes.DataProductGovernance.BusinessDomain
# Row: Term1,Description,REF-001,Finance

pvw uc term import-csv --domain-id 'bc785cdb-11c3-4227-ab44-f6ad44048623' --csv-file glossaire_terms.csv
```

### Example 2: Update Existing Term Custom Attributes

```bash
pvw uc term update --term-id 'abc-123-def' --custom-attributes '{
  "DataProductGovernance": {
    "BusinessDomain": "Finance",
    "ComplianceStatus": "Approved",
    "DataClassification": "PII"
  }
}'
```

### Example 3: Bulk Update with CSV

```bash
# Create CSV: updates.csv
# Headers: term_id,customAttributes.DataProductGovernance.BusinessDomain,customAttributes.DataProductGovernance.ComplianceStatus
# Rows: term-1,Finance,Compliant
#       term-2,Sales,Approved

pvw uc term update-csv --csv-file updates.csv
```

## Contributors
- Ayoub Keayoub

## Questions or Issues?
Please report issues on GitHub with:
- Custom attributes structure
- Custom attribute values not appearing in UI
- CSV format questions
